<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Synopsis Transformer - Fabric AI Services</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        
        .gradient-text {
            background: linear-gradient(to right, #22d3ee, #a855f7, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .gradient-bg {
            background: linear-gradient(to right, #0891b2, #7c3aed);
        }
        
        .gradient-bg:hover {
            background: linear-gradient(to right, #0e7490, #6d28d9);
        }
        
        .gradient-bg-green {
            background: linear-gradient(to right, #059669, #0891b2);
        }
        
        .gradient-bg-green:hover {
            background: linear-gradient(to right, #047857, #0e7490);
        }
        
        .backdrop-blur {
            backdrop-filter: blur(8px);
        }
        
        .grid-pattern {
            background-image: 
                linear-gradient(rgba(0,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,255,255,0.03) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        
        .floating-element {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            border: 1px solid #374151;
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .file-drop-zone {
            border: 2px dashed #374151;
            transition: all 0.3s ease;
        }
        
        .file-drop-zone.dragover {
            border-color: #22d3ee;
            background-color: rgba(34, 211, 238, 0.05);
        }
    </style>
</head>
<body class="min-h-screen bg-black relative overflow-x-hidden">
     Animated Background Grid 
    <div class="absolute inset-0 grid-pattern animate-pulse"></div>

     Floating Futuristic Elements 
    <div class="fixed inset-0 pointer-events-none overflow-hidden">
        <div class="absolute top-20 right-20 opacity-20 floating-element">
            <div class="w-32 h-24 bg-gradient-to-br from-cyan-500/20 to-purple-500/20 rounded-lg border border-cyan-500/30 flex items-center justify-center backdrop-blur">
                <i data-lucide="brain" class="w-16 h-16 text-cyan-400"></i>
            </div>
        </div>
        <div class="absolute top-1/3 left-10 opacity-20 floating-element" style="animation-delay: -2s;">
            <div class="w-28 h-20 bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-lg border border-purple-500/30 flex items-center justify-center backdrop-blur">
                <i data-lucide="cpu" class="w-12 h-12 text-purple-400"></i>
            </div>
        </div>
        <div class="absolute bottom-32 right-1/4 opacity-20 floating-element" style="animation-delay: -4s;">
            <div class="w-24 h-24 bg-gradient-to-br from-green-500/20 to-cyan-500/20 rounded-lg border border-green-500/30 flex items-center justify-center backdrop-blur">
                <i data-lucide="network" class="w-10 h-10 text-green-400"></i>
            </div>
        </div>
        <div class="absolute top-1/2 right-10 opacity-20 floating-element" style="animation-delay: -1s;">
            <div class="w-20 h-20 bg-gradient-to-br from-yellow-500/20 to-orange-500/20 rounded-lg border border-yellow-500/30 flex items-center justify-center backdrop-blur">
                <i data-lucide="code-2" class="w-8 h-8 text-yellow-400"></i>
            </div>
        </div>
    </div>

    <div class="relative max-w-5xl mx-auto px-6 py-8">
         Header with Fabric AI Services Branding 
        <div class="text-center space-y-4 mb-8">
            <div class="flex items-center justify-center gap-4 mb-4">
                <img
                    src="https://framerusercontent.com/assets/YhHtO4AfpyCgmWFZ6i3dcmRLcAI.png"
                    alt="Fabric AI Services"
                    class="h-10 w-auto"
                />
                <div class="h-6 w-px bg-gradient-to-b from-cyan-500 to-purple-500"></div>
                <span class="text-cyan-400 font-semibold text-base tracking-wide">FABRIC AI SERVICES</span>
            </div>

            <h1 class="text-4xl font-bold gradient-text">
                Synopsis Transformer
            </h1>
            <p class="text-lg text-gray-300 max-w-3xl mx-auto leading-relaxed">
                Advanced file upload and transformation system. Upload VTT files for processing and retrieve results with real-time analytics.
            </p>

             Tech Stats 
            <div class="flex items-center justify-center gap-6 pt-2">
                <div class="flex items-center gap-2 text-cyan-400">
                    <i data-lucide="zap" class="w-3 h-3"></i>
                    <span class="text-xs font-mono">NEURAL ENGINE</span>
                </div>
                <div class="flex items-center gap-2 text-purple-400">
                    <i data-lucide="upload-cloud" class="w-3 h-3"></i>
                    <span class="text-xs font-mono">CLOUD STORAGE</span>
                </div>
                <div class="flex items-center gap-2 text-green-400">
                    <i data-lucide="network" class="w-3 h-3"></i>
                    <span class="text-xs font-mono">REAL-TIME</span>
                </div>
            </div>
        </div>

         Configuration Panel 
        <div class="border border-gray-800 bg-gray-900/50 backdrop-blur rounded-lg shadow-2xl shadow-cyan-500/10 mb-6">
            <div class="border-b border-gray-800 p-4">
                <h2 class="text-xl font-bold text-white flex items-center gap-3">
                    <div class="w-2 h-2 bg-cyan-400 rounded-full animate-pulse"></div>
                    Configuration
                </h2>
            </div>
            <div class="p-6 space-y-4">
                <div class="space-y-4">
                    <label for="uploadEndpoint" class="text-sm font-semibold text-cyan-400 uppercase tracking-wider flex items-center gap-2">
                        <i data-lucide="upload" class="w-4 h-4"></i>
                        Upload API Endpoint
                    </label>
                    <input
                        id="uploadEndpoint"
                        type="text"
                        placeholder="https://your-api/upload"
                        class="w-full font-mono text-sm bg-black/50 border border-gray-700 text-white placeholder-gray-500 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 rounded-md px-3 py-2 outline-none"
                    />
                </div>

                <div class="space-y-4">
                    <label for="resultsEndpoint" class="text-sm font-semibold text-purple-400 uppercase tracking-wider flex items-center gap-2">
                        <i data-lucide="database" class="w-4 h-4"></i>
                        Results API Endpoint
                    </label>
                    <input
                        id="resultsEndpoint"
                        type="text"
                        placeholder="https://your-api/results"
                        class="w-full font-mono text-sm bg-black/50 border border-gray-700 text-white placeholder-gray-500 focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20 rounded-md px-3 py-2 outline-none"
                    />
                </div>

                <div class="space-y-4">
                    <label for="userId" class="text-sm font-semibold text-green-400 uppercase tracking-wider flex items-center gap-2">
                        <i data-lucide="user" class="w-4 h-4"></i>
                        User ID
                    </label>
                    <input
                        id="userId"
                        type="text"
                        placeholder="rafa"
                        class="w-full font-mono text-sm bg-black/50 border border-gray-700 text-white placeholder-gray-500 focus:border-green-500 focus:ring-2 focus:ring-green-500/20 rounded-md px-3 py-2 outline-none"
                    />
                </div>
            </div>
        </div>

         Upload Section 
        <div class="border border-gray-800 bg-gray-900/50 backdrop-blur rounded-lg shadow-2xl shadow-purple-500/10 mb-6">
            <div class="border-b border-gray-800 p-4">
                <h2 class="text-xl font-bold text-white flex items-center gap-3">
                    <div class="w-2 h-2 bg-purple-400 rounded-full animate-pulse"></div>
                    Upload Files
                </h2>
            </div>
            <div class="p-6 space-y-6">
                <div class="space-y-4">
                    <label class="text-sm font-semibold text-purple-400 uppercase tracking-wider flex items-center gap-2">
                        <i data-lucide="file-video" class="w-4 h-4"></i>
                        VTT Files
                    </label>
                    <div id="fileDropZone" class="file-drop-zone p-6 rounded-lg text-center cursor-pointer">
                        <input type="file" id="fileInput" accept=".vtt" multiple class="hidden">
                        <div class="space-y-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-full flex items-center justify-center mx-auto border border-purple-500/30">
                                <i data-lucide="upload" class="w-6 h-6 text-purple-400"></i>
                            </div>
                            <div>
                                <p class="text-white font-semibold">Drop VTT files here or click to browse</p>
                                <p class="text-gray-400 text-sm mt-1">Multiple files supported</p>
                            </div>
                        </div>
                    </div>
                    <div id="fileInfo" class="hidden p-4 bg-purple-500/10 border border-purple-500/30 rounded-lg">
                        <div class="flex items-center gap-3">
                            <i data-lucide="file-check" class="w-5 h-5 text-purple-400"></i>
                            <div>
                                <p id="fileCount" class="text-white font-semibold"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex items-center gap-4 flex-wrap pt-4">
                    <button
                        id="uploadBtn"
                        class="gradient-bg text-white px-6 py-2.5 text-sm font-semibold shadow-lg shadow-purple-500/25 transition-all duration-300 rounded-md flex items-center gap-2"
                    >
                        <i data-lucide="upload-cloud" class="w-4 h-4"></i>
                        Upload & Transform
                    </button>
                    <span id="uploadStatus" class="text-sm text-gray-400 font-mono"></span>
                </div>
            </div>
        </div>

         Results Section 
        <div class="border border-gray-800 bg-gray-900/50 backdrop-blur rounded-lg shadow-2xl shadow-green-500/10">
            <div class="border-b border-gray-800 p-4">
                <h2 class="text-xl font-bold text-white flex items-center gap-3">
                    <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    Results
                </h2>
            </div>
            <div class="p-6 space-y-6">
                <div class="flex items-center gap-4 flex-wrap">
                    <button
                        id="fetchBtn"
                        class="gradient-bg-green text-white px-6 py-2.5 text-sm font-semibold shadow-lg shadow-green-500/25 transition-all duration-300 rounded-md flex items-center gap-2"
                    >
                        <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                        Fetch Results
                    </button>
                </div>

                <div id="results" class="space-y-4">
                    <div class="text-center py-8">
                        <div class="w-12 h-12 bg-gradient-to-br from-gray-800 to-gray-700 rounded-full flex items-center justify-center mx-auto mb-3 border border-gray-600">
                            <i data-lucide="database" class="w-6 h-6 text-gray-400"></i>
                        </div>
                        <p class="text-gray-400 font-mono text-xs">No results yet...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

     Toast Container 
    <div id="toastContainer"></div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // DOM elements
        const uploadBtn = document.getElementById("uploadBtn");
        const fetchBtn = document.getElementById("fetchBtn");
        const uploadStatus = document.getElementById("uploadStatus");
        const resultsDiv = document.getElementById("results");
        const fileDropZone = document.getElementById("fileDropZone");
        const fileInput = document.getElementById("fileInput");
        const fileInfo = document.getElementById("fileInfo");
        const fileCount = document.getElementById("fileCount");

        let selectedFiles = [];

        // Toast notification function
        function showToast(title, description, variant = 'default') {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
                <div class="font-semibold">${title}</div>
                <div class="text-sm text-gray-300">${description}</div>
            `;
            
            if (variant === 'destructive') {
                toast.style.borderColor = '#ef4444';
                toast.style.backgroundColor = 'rgba(239, 68, 68, 0.1)';
            }
            
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 3000);
        }

        // File drop zone events
        fileDropZone.addEventListener('click', () => fileInput.click());
        fileDropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileDropZone.classList.add('dragover');
        });
        fileDropZone.addEventListener('dragleave', () => {
            fileDropZone.classList.remove('dragover');
        });
        fileDropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            fileDropZone.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileSelect(files);
            }
        });
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileSelect(e.target.files);
            }
        });

        function handleFileSelect(files) {
            selectedFiles = Array.from(files);
            fileCount.textContent = `${selectedFiles.length} file(s) selected`;
            fileInfo.classList.remove('hidden');
            showToast('Files Selected', `${selectedFiles.length} VTT file(s) ready for upload`);
        }

        // Handle file upload
        uploadBtn.addEventListener("click", async () => {
            const endpoint = document.getElementById("uploadEndpoint").value.trim();
            const userId = document.getElementById("userId").value.trim();

            if (!endpoint || !userId || selectedFiles.length === 0) {
                showToast('Error', 'Please set endpoint, user ID and choose at least one file', 'destructive');
                return;
            }

            uploadStatus.innerHTML = '<div class="flex items-center gap-2"><i data-lucide="loader-2" class="w-3 h-3 animate-spin"></i>Uploading...</div>';
            uploadBtn.disabled = true;
            uploadBtn.innerHTML = '<div class="w-4 h-4 animate-spin"><i data-lucide="loader-2" class="w-4 h-4"></i></div>Processing...';
            lucide.createIcons();

            const fileArray = [];
            for (const file of selectedFiles) {
                const text = await file.text();
                fileArray.push({
                    file_name: file.name,
                    file_content: text
                });
            }

            try {
                const response = await fetch(endpoint, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ user_id: userId, files: fileArray })
                });

                const result = await response.json();
                if (response.ok) {
                    uploadStatus.textContent = "Upload successful!";
                    showToast('Success', `${selectedFiles.length} file(s) uploaded successfully`);
                } else {
                    uploadStatus.textContent = "Error: " + JSON.stringify(result);
                    showToast('Error', 'Upload failed: ' + JSON.stringify(result), 'destructive');
                }
            } catch (err) {
                uploadStatus.textContent = "Error: " + err.message;
                showToast('Error', 'Network error: ' + err.message, 'destructive');
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.innerHTML = '<i data-lucide="upload-cloud" class="w-4 h-4"></i>Upload & Transform';
                lucide.createIcons();
            }
        });

        // Handle results fetch
        fetchBtn.addEventListener("click", async () => {
            const endpoint = document.getElementById("resultsEndpoint").value.trim();
            const userId = document.getElementById("userId").value.trim();

            if (!endpoint || !userId) {
                showToast('Error', 'Please set endpoint and user ID', 'destructive');
                return;
            }

            resultsDiv.innerHTML = `
                <div class="text-center py-8">
                    <div class="w-12 h-12 bg-gradient-to-br from-gray-800 to-gray-700 rounded-full flex items-center justify-center mx-auto mb-3 border border-gray-600 animate-pulse">
                        <i data-lucide="loader-2" class="w-6 h-6 text-gray-400 animate-spin"></i>
                    </div>
                    <p class="text-gray-400 font-mono text-xs">Loading results...</p>
                </div>
            `;
            lucide.createIcons();

            try {
                const response = await fetch(endpoint, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ user_id: userId })
                });

                const data = await response.json();
                if (!response.ok) {
                    resultsDiv.innerHTML = `<pre class="text-red-400 text-xs bg-black/50 p-4 rounded border border-red-500/30">${JSON.stringify(data, null, 2)}</pre>`;
                    showToast('Error', 'Failed to fetch results', 'destructive');
                    return;
                }

                const sessions = data.sessions || {};
                if (Object.keys(sessions).length === 0) {
                    resultsDiv.innerHTML = `
                        <div class="text-center py-8">
                            <div class="w-12 h-12 bg-gradient-to-br from-gray-800 to-gray-700 rounded-full flex items-center justify-center mx-auto mb-3 border border-gray-600">
                                <i data-lucide="inbox" class="w-6 h-6 text-gray-400"></i>
                            </div>
                            <p class="text-gray-400 font-mono text-xs">No sessions found</p>
                        </div>
                    `;
                    lucide.createIcons();
                    return;
                }

                let html = "";
                for (const [session, details] of Object.entries(sessions)) {
                    html += `
                        <div class="border border-gray-700 bg-black/30 backdrop-blur rounded-lg">
                            <div class="p-4 border-b border-gray-700">
                                <div class="flex items-center justify-between">
                                    <h3 class="text-lg font-bold text-purple-400 flex items-center gap-2">
                                        <i data-lucide="folder" class="w-5 h-5"></i>
                                        Session: ${session}
                                    </h3>
                                    <div class="flex items-center gap-3 text-sm">
                                        <span class="px-2 py-1 rounded-full text-xs font-semibold border bg-cyan-500/20 text-cyan-400 border-cyan-500/50">
                                            ${details.count} files
                                        </span>
                                        <span class="px-2 py-1 rounded-full text-xs font-semibold border bg-green-500/20 text-green-400 border-green-500/50">
                                            ${details.total_size} bytes
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="p-4">
                                <ul class="space-y-2">
                    `;
                    details.files.forEach(file => {
                        const s3Url = `https://s3.console.aws.amazon.com/s3/object/synopsis-transformer-files?region=us-east-2&prefix=${file.key}`;
                        html += `
                            <li class="flex justify-between items-center bg-gray-800/50 px-4 py-3 rounded-lg border border-gray-700 hover:border-green-500/50 transition-colors">
                                <div class="flex items-center gap-3">
                                    <i data-lucide="file-text" class="w-4 h-4 text-gray-400"></i>
                                    <div>
                                        <p class="text-sm text-white font-mono">${file.key}</p>
                                        <p class="text-xs text-gray-400">${file.size} bytes</p>
                                    </div>
                                </div>
                                <a href="${s3Url}" target="_blank"
                                    class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-md text-sm font-semibold text-white flex items-center gap-2 transition-colors">
                                    <i data-lucide="download" class="w-4 h-4"></i>
                                    Download
                                </a>
                            </li>
                        `;
                    });
                    html += `</ul></div></div>`;
                }
                resultsDiv.innerHTML = html;
                lucide.createIcons();
                showToast('Success', `Found ${Object.keys(sessions).length} session(s)`);
            } catch (err) {
                resultsDiv.innerHTML = `<pre class="text-red-400 text-xs bg-black/50 p-4 rounded border border-red-500/30">Error: ${err.message}</pre>`;
                showToast('Error', 'Network error: ' + err.message, 'destructive');
            }
        });

        // Initialize icons
        lucide.createIcons();
    </script>
</body>
</html>
